using System;
using System.Collections.Generic;
using System.Collections;
using System.Text;
using System.Runtime.InteropServices;

namespace Nistec
{

    class Program
    {

        [STAThread]
        static void Main(string[] args)
        {

            Console.WriteLine("Start test...");

            string mode = "remote";
            //QClient.RuntimeTest();
            //QClient.ReadFile(@"D:\Nistec\Services\MQueue\Queues\Queue\Demo\c11e3ce4b53\c11e3ce4b53b0a8bf.mcq");

            switch (mode)
            {
                case "remote":
                    QClient.Test();
                    QListener.Test();
                    break;
                case "db":
                    break;
                case "file":
                    break;
                case "ipc":
                    break;
                case "tcp":
                    break;
                case "report":
                    break;
            }

            Console.WriteLine("Finished...");
            Console.ReadLine();


        }

        public static int GetUsage()
        {

            System.Diagnostics.Process[] process = System.Diagnostics.Process.GetProcessesByName("McRemoteCache");
            int usage = 0;
            if (process == null)
                return 0;
            for (int i = 0; i < process.Length; i++)
            {
                usage += (int)((int)process[i].WorkingSet64) / 1024;
            }

            return usage;
        }

        static string GetBase64Item()
        {
            return @"AAEAAAD/////AQAAAAAAAAAMAgAAAEVNQ29udHJvbC5DYWNoZSwgVmVyc2lvbj0zLjUuMC4wLCBDdWx0dXJlPW5ldXRyYWwsIFB1YmxpY0tleVRva2VuPW51bGwMAwAAAEJOZXRjZWxsLkxpYiwgVmVyc2lvbj0zLjUuNC4zLCBDdWx0dXJlPW5ldXRyYWwsIFB1YmxpY0tleVRva2VuPW51bGwFAQAAABxNQ29udHJvbC5DYWNoaW5nLkdlbmVyaWNJdGVtAgAAAAVfc2l6ZRY8VmFsdWU+a19fQmFja2luZ0ZpZWxkAAIIAgAAAAYAAAAJBAAAAAUEAAAAH05ldGNlbGwuTGliLk1vYmlsZS5XYXBJdGVtc0xpc3QJAAAAC1ZpcnR1YWxQYXRoC1Boc3ljYWxQYXRoClNhbXBsZVBhdGgIUGVyc29uYWwPUGVyc29uYWxEaXNwbGF5A0NzcwVUaXRsZQhNYXhXaWR0aAdtX2l0ZW1zAQEBAQEBAQADCNcCU3lzdGVtLkNvbGxlY3Rpb25zLkdlbmVyaWMuRGljdGlvbmFyeWAyW1tTeXN0ZW0uSW50MzIsIG1zY29ybGliLCBWZXJzaW9uPTIuMC4wLjAsIEN1bHR1cmU9bmV1dHJhbCwgUHVibGljS2V5VG9rZW49Yjc3YTVjNTYxOTM0ZTA4OV0sW1N5c3RlbS5Db2xsZWN0aW9ucy5HZW5lcmljLkxpc3RgMVtbTmV0Y2VsbC5MaWIuTW9iaWxlLldhcEl0ZW0sIE5ldGNlbGwuTGliLCBWZXJzaW9uPTMuNS40LjMsIEN1bHR1cmU9bmV1dHJhbCwgUHVibGljS2V5VG9rZW49bnVsbF1dLCBtc2NvcmxpYiwgVmVyc2lvbj0yLjAuMC4wLCBDdWx0dXJlPW5ldXRyYWwsIFB1YmxpY0tleVRva2VuPWI3N2E1YzU2MTkzNGUwODldXQMAAAAKCgoKCgoKAAAAAAkFAAAABAUAAADXAlN5c3RlbS5Db2xsZWN0aW9ucy5HZW5lcmljLkRpY3Rpb25hcnlgMltbU3lzdGVtLkludDMyLCBtc2NvcmxpYiwgVmVyc2lvbj0yLjAuMC4wLCBDdWx0dXJlPW5ldXRyYWwsIFB1YmxpY0tleVRva2VuPWI3N2E1YzU2MTkzNGUwODldLFtTeXN0ZW0uQ29sbGVjdGlvbnMuR2VuZXJpYy5MaXN0YDFbW05ldGNlbGwuTGliLk1vYmlsZS5XYXBJdGVtLCBOZXRjZWxsLkxpYiwgVmVyc2lvbj0zLjUuNC4zLCBDdWx0dXJlPW5ldXRyYWwsIFB1YmxpY0tleVRva2VuPW51bGxdXSwgbXNjb3JsaWIsIFZlcnNpb249Mi4wLjAuMCwgQ3VsdHVyZT1uZXV0cmFsLCBQdWJsaWNLZXlUb2tlbj1iNzdhNWM1NjE5MzRlMDg5XV0EAAAAB1ZlcnNpb24IQ29tcGFyZXIISGFzaFNpemUNS2V5VmFsdWVQYWlycwADAAMIkQFTeXN0ZW0uQ29sbGVjdGlvbnMuR2VuZXJpYy5HZW5lcmljRXF1YWxpdHlDb21wYXJlcmAxW1tTeXN0ZW0uSW50MzIsIG1zY29ybGliLCBWZXJzaW9uPTIuMC4wLjAsIEN1bHR1cmU9bmV1dHJhbCwgUHVibGljS2V5VG9rZW49Yjc3YTVjNTYxOTM0ZTA4OV1dCNsCU3lzdGVtLkNvbGxlY3Rpb25zLkdlbmVyaWMuS2V5VmFsdWVQYWlyYDJbW1N5c3RlbS5JbnQzMiwgbXNjb3JsaWIsIFZlcnNpb249Mi4wLjAuMCwgQ3VsdHVyZT1uZXV0cmFsLCBQdWJsaWNLZXlUb2tlbj1iNzdhNWM1NjE5MzRlMDg5XSxbU3lzdGVtLkNvbGxlY3Rpb25zLkdlbmVyaWMuTGlzdGAxW1tOZXRjZWxsLkxpYi5Nb2JpbGUuV2FwSXRlbSwgTmV0Y2VsbC5MaWIsIFZlcnNpb249My41LjQuMywgQ3VsdHVyZT1uZXV0cmFsLCBQdWJsaWNLZXlUb2tlbj1udWxsXV0sIG1zY29ybGliLCBWZXJzaW9uPTIuMC4wLjAsIEN1bHR1cmU9bmV1dHJhbCwgUHVibGljS2V5VG9rZW49Yjc3YTVjNTYxOTM0ZTA4OV1dW10BAAAACQYAAAADAAAACQcAAAAEBgAAAJEBU3lzdGVtLkNvbGxlY3Rpb25zLkdlbmVyaWMuR2VuZXJpY0VxdWFsaXR5Q29tcGFyZXJgMVtbU3lzdGVtLkludDMyLCBtc2NvcmxpYiwgVmVyc2lvbj0yLjAuMC4wLCBDdWx0dXJlPW5ldXRyYWwsIFB1YmxpY0tleVRva2VuPWI3N2E1YzU2MTkzNGUwODldXQAAAAAHBwAAAAABAAAAAQAAAAPZAlN5c3RlbS5Db2xsZWN0aW9ucy5HZW5lcmljLktleVZhbHVlUGFpcmAyW1tTeXN0ZW0uSW50MzIsIG1zY29ybGliLCBWZXJzaW9uPTIuMC4wLjAsIEN1bHR1cmU9bmV1dHJhbCwgUHVibGljS2V5VG9rZW49Yjc3YTVjNTYxOTM0ZTA4OV0sW1N5c3RlbS5Db2xsZWN0aW9ucy5HZW5lcmljLkxpc3RgMVtbTmV0Y2VsbC5MaWIuTW9iaWxlLldhcEl0ZW0sIE5ldGNlbGwuTGliLCBWZXJzaW9uPTMuNS40LjMsIEN1bHR1cmU9bmV1dHJhbCwgUHVibGljS2V5VG9rZW49bnVsbF1dLCBtc2NvcmxpYiwgVmVyc2lvbj0yLjAuMC4wLCBDdWx0dXJlPW5ldXRyYWwsIFB1YmxpY0tleVRva2VuPWI3N2E1YzU2MTkzNGUwODldXQT4////2QJTeXN0ZW0uQ29sbGVjdGlvbnMuR2VuZXJpYy5LZXlWYWx1ZVBhaXJgMltbU3lzdGVtLkludDMyLCBtc2NvcmxpYiwgVmVyc2lvbj0yLjAuMC4wLCBDdWx0dXJlPW5ldXRyYWwsIFB1YmxpY0tleVRva2VuPWI3N2E1YzU2MTkzNGUwODldLFtTeXN0ZW0uQ29sbGVjdGlvbnMuR2VuZXJpYy5MaXN0YDFbW05ldGNlbGwuTGliLk1vYmlsZS5XYXBJdGVtLCBOZXRjZWxsLkxpYiwgVmVyc2lvbj0zLjUuNC4zLCBDdWx0dXJlPW5ldXRyYWwsIFB1YmxpY0tleVRva2VuPW51bGxdXSwgbXNjb3JsaWIsIFZlcnNpb249Mi4wLjAuMCwgQ3VsdHVyZT1uZXV0cmFsLCBQdWJsaWNLZXlUb2tlbj1iNzdhNWM1NjE5MzRlMDg5XV0CAAAAA2tleQV2YWx1ZQADCIMBU3lzdGVtLkNvbGxlY3Rpb25zLkdlbmVyaWMuTGlzdGAxW1tOZXRjZWxsLkxpYi5Nb2JpbGUuV2FwSXRlbSwgTmV0Y2VsbC5MaWIsIFZlcnNpb249My41LjQuMywgQ3VsdHVyZT1uZXV0cmFsLCBQdWJsaWNLZXlUb2tlbj1udWxsXV0AAAAACQkAAAAECQAAAIMBU3lzdGVtLkNvbGxlY3Rpb25zLkdlbmVyaWMuTGlzdGAxW1tOZXRjZWxsLkxpYi5Nb2JpbGUuV2FwSXRlbSwgTmV0Y2VsbC5MaWIsIFZlcnNpb249My41LjQuMywgQ3VsdHVyZT1uZXV0cmFsLCBQdWJsaWNLZXlUb2tlbj1udWxsXV0DAAAABl9pdGVtcwVfc2l6ZQhfdmVyc2lvbgQAABxOZXRjZWxsLkxpYi5Nb2JpbGUuV2FwSXRlbVtdAwAAAAgICQoAAAAIAAAACAAAAAcKAAAAAAEAAAAIAAAABBpOZXRjZWxsLkxpYi5Nb2JpbGUuV2FwSXRlbQMAAAAJCwAAAAkMAAAACQ0AAAAJDgAAAAkPAAAACRAAAAAJEQAAAAkSAAAABQsAAAAaTmV0Y2VsbC5MaWIuTW9iaWxlLldhcEl0ZW0RAAAABVZhbHVlB0NhcHRpb24LV2FwSXRlbVR5cGUETmFtZQhDc3NTdHlsZQhDc3NDbGFzcwdPcmRlcklkBkZvcm1JZAVXaWR0aAZIZWlnaHQEWm9vbQpJc1JlbG9hZGVkA0RpcgRBcmdzC0Rpc3BsYXlUeXBlBV9IcmVmBkl0ZW1JZAEBBAEBAQAAAAAAAAQBBAEAHk5ldGNlbGwuTGliLk1vYmlsZS5XYXBJdGVtVHlwZQMAAAAICAgICAEPTmV0Y2VsbC5MaWIuRGlyAwAAAB5OZXRjZWxsLkxpYi5Nb2JpbGUuRGlzcGxheVR5cGUDAAAACAMAAAAGEwAAAIkBPGRpdiBkaXI9InJ0bCIgY2xhc3M9IldJbWciPjxhIGhyZWY9IiMiIHRpdGxlPSIiID48aW1nIHNyYz0iaHR0cDovL215LXQuY28uaWwvVXBsb2Fkcy83MDAwMC93YXAv16nXoS9MaWt1ZF9Mb2dvLmpwZyIgYWx0PSIiICAvPjwvYT48L2Rpdj4GFAAAAAAF6////x5OZXRjZWxsLkxpYi5Nb2JpbGUuV2FwSXRlbVR5cGUBAAAAB3ZhbHVlX18ACAMAAAAOAAAABhYAAAAEV0ltZwkUAAAACgAAAAAAAAAAAAAAAAAAAABkAAAAAQXo////D05ldGNlbGwuTGliLkRpcgEAAAAHdmFsdWVfXwAIAwAAAAAAAAAKBef///8eTmV0Y2VsbC5MaWIuTW9iaWxlLkRpc3BsYXlUeXBlAQAAAAd2YWx1ZV9fAAgDAAAAAAAAAAoAAAAAAQwAAAALAAAABhoAAAC8ATxkaXYgZGlyPSJydGwiIGNsYXNzPSJXSW1nIj48YSBocmVmPSJodHRwOi8vd3d3LnlvdXR1YmUuY29tL3dhdGNoP3Y9dWxHUFViMWI4cTAiIHRpdGxlPSIiICB0YWJpbmRleD0iMSI+PGltZyBzcmM9Imh0dHA6Ly9teS10LmNvLmlsL1VwbG9hZHMvNzAwMDAvd2FwL9ep16EveW91dHViZS5qcGciIGFsdD0iIiAgLz48L2E+PC9kaXY+CRQAAAAB5P///+v///8OAAAABh0AAAAEV0ltZwkUAAAACgAAAAAAAAAAAAAAAAAAAABkAAAAAQHh////6P///wAAAAAKAeD////n////AAAAAAoAAAAAAQ0AAAALAAAABiEAAACYATxkaXYgZGlyPSJydGwiIGNsYXNzPSJXSW1nIj48YSBocmVmPSIjIiB0aXRsZT0iIiA+PGltZyBzcmM9Imh0dHA6Ly9teS10LmNvLmlsL1VwbG9hZHMvNzAwMDAvd2FwL9ep16Ev16nXqCDXlNeQ15XXpteoINeZ15XXkdecIC5qcGciIGFsdD0iIiAgLz48L2E+PC9kaXY+CRQAAAAB3f///+v///8OAAAABiQAAAAEV0ltZwkUAAAACgAAAAAAAAAAAAAAAAAAAABkAAAAAQHa////6P///wAAAAAKAdn////n////AAAAAAoAAAAAAQ4AAAALAAAABigAAADGATxkaXYgZGlyPSJydGwiIGNsYXNzPSJXSW1nIj48YSBocmVmPSJodHRwOi8vd3d3LmZhY2Vib29rLmNvbS9MaWt1ZE5ldGFueWFodSIgdGl0bGU9IiIgIHRhYmluZGV4PSIxIj48aW1nIHNyYz0iaHR0cDovL215LXQuY28uaWwvVXBsb2Fkcy83MDAwMC93YXAv16nXoS9mYWNlYm9vay1sb2dvLTMwMHgxNzIuanBnIiBhbHQ9IiIgIC8+PC9hPjwvZGl2PgkUAAAAAdb////r////DgAAAAYrAAAABFdJbWcJFAAAAAoAAAAAAAAAAAAAAAAAAAAAZAAAAAEB0////+j///8AAAAACgHS////5////wAAAAAKAAAAAAEPAAAACwAAAAYvAAAAfjxkaXYgY2xhc3M9IldDYXB0aW9uIj48aDEgc3R5bGU9InRleHQtYWxpZ246Y2VudGVyOyIgY2xhc3M9Im1vYmlsZS1jYXB0aW9uYmFyIHdjYmFyLWJsdWUiID7XlNem15jXqNek15Ug15DXnNeZ16DXlSE8L2gxPjwvZGl2PgkUAAAAAc/////r////EgAAAAYyAAAACFdDYXB0aW9uCRQAAAAKAAAAAAAAAAAAAAAAAAAAAGQAAAABAcz////o////AAAAAAoBy////+f///8AAAAACgAAAAABEAAAAAsAAAAGNgAAAKUHPGRpdiBjbGFzcz0iV0Zvcm0iIHN0eWxlPSJkaXJlY3Rpb246cnRsO21hcmdpbjoxMHB4O3RleHQtYWxpZ246Y2VudGVyOyIgPjxmb3JtIGFjdGlvbj0iRm9ybXMvUmVnaXN0cnlBY3Rpb24uYXNweCIgbWV0aG9kPSJwb3N0IiBlbmN0eXBlPSJtdWx0aXBhcnQvZm9ybS1kYXRhIiBvbnN1Ym1pdD0icmV0dXJuIG9uU3VibWl0Rm9ybSgpIiBjbGFzcz0ibW9iaWxlLWZvcm1iYXIgd2NiYXItYmx1ZSIgPjx1bCBzdHlsZT0ibWFyZ2luOjEwcHgiPjxsaT7XqdedINeV16nXnSDXntep16TXl9eUIDwvbGk+PGxpPjxpbnB1dCB0eXBlPSJ0ZXh0IiBuYW1lPSJ0eHRuYW1lIiBkYXRhLXJlcXVpcmVkPSIxIiBjbGFzcz0iV0ZpZWxkIiB2YWx1ZT0iIiAvPjwvbGk+PGxpPteY15zXpNeV158gPC9saT48bGk+PGlucHV0IHR5cGU9InRleHQiIG5hbWU9InR4dHBob25lIiBkYXRhLXJlcXVpcmVkPSIxIiBjbGFzcz0iV0ZpZWxkIiB2YWx1ZT0iIiAvPjwvbGk+PGxpPteT15XXkNecIDwvbGk+PGxpPjxpbnB1dCB0eXBlPSJ0ZXh0IiBuYW1lPSJ0eHRtYWlsIiBkYXRhLXJlcXVpcmVkPSIxIiBjbGFzcz0iV0ZpZWxkIiB2YWx1ZT0iIiAvPjwvbGk+PGxpPjxpbnB1dCB0eXBlPSJzdWJtaXQiIGNsYXNzPSJ3aWJhci1ibHVlIiBzdHlsZT0icGFkZGluZzo1cHgiIHZhbHVlPSLXkNeZ16nXldeoIi8+PC9saT48L3VsPjxpbnB1dCB0eXBlPSJoaWRkZW4iIGlkPSJyZWdpc3RyeWlkIiBuYW1lPSJyZWdpc3RyeWlkIiBjbGFzcz0iV0ZpZWxkIiB2YWx1ZT0iMSIvPjxpbnB1dCB0eXBlPSJoaWRkZW4iIGlkPSJjYXRhbG9naWQiIG5hbWU9ImNhdGFsb2dpZCIgY2xhc3M9IldGaWVsZCIgdmFsdWU9IjMiLz48aW5wdXQgdHlwZT0iaGlkZGVuIiBpZD0iZm9ybXR5cGUiIG5hbWU9ImZvcm10eXBlIiBjbGFzcz0iV0ZpZWxkIiB2YWx1ZT0icmVnaXN0cnkiLz48L2Zvcm0+PC9kaXY+CRQAAAAByP///+v///8NAAAABjkAAAAFV0Zvcm0JFAAAAAoAAAAAAAAAAAAAAAAAAAAAZAAAAAEBxf///+j///8AAAAACgHE////5////wAAAAAKAAAAAAERAAAACwAAAAY9AAAA+AQ8ZGl2IGNsYXNzPSJXQ29uZmlybSI+PHAgIHN0eWxlPSJjb2xvcjpyZ2IoMjU1LCAyNTUsIDI1NSk7YmFja2dyb3VuZC1jb2xvcjpyZ2IoMCwgNDgsIDEzOSk7Zm9udC13ZWlnaHQ6Ym9sZDt0ZXh0LWFsaWduOmNlbnRlcjtmb250LXNpemU6MTRweDsiPteQ150g15TXkdeX15nXqNeV16og15TXmdeVINee16rXp9eZ15nXnteV16og15TXmdeV150g15TXkNedINeq15HXl9eoINeU15zXmdeb15XXkz88L3A+PHVsICBzdHlsZT0iY29sb3I6cmdiKDI1NSwgMjU1LCAyNTUpO2JhY2tncm91bmQtY29sb3I6cmdiKDAsIDQ4LCAxMzkpO2ZvbnQtd2VpZ2h0OmJvbGQ7dGV4dC1hbGlnbjpjZW50ZXI7Zm9udC1zaXplOjE0cHg7Ij48bGk+PGEgaHJlZj0iQ29uZmlybS8jaWQjLzEvMy5odG0iIGRhdGEtY29uZmlybT0iMTszIiAgc3R5bGU9ImNvbG9yOnJnYigyNTUsIDI1NSwgMjU1KTtmb250LXNpemU6MTRweDtmb250LXdlaWdodDpib2xkOyI+15vXnyA8L2E+PC9saT48bGk+PGEgaHJlZj0iQ29uZmlybS8jaWQjLzIvMy5odG0iIGRhdGEtY29uZmlybT0iMjszIiAgc3R5bGU9ImNvbG9yOnJnYigyNTUsIDI1NSwgMjU1KTtmb250LXNpemU6MTRweDtmb250LXdlaWdodDpib2xkOyI+15zXkCA8L2E+PC9saT48L3VsPjwvZGl2PgkUAAAAAcH////r////BgAAAAZAAAAACFdDb25maXJtCRQAAAAKAAAAAAAAAAAAAAAAAAAAAGQAAAABAb7////o////AAAAAAoBvf///+f///8AAAAACgAAAAABEgAAAAsAAAAGRAAAAAU8ZW5kPgkUAAAAAbr////r////AAAAAAoJFAAAAAoAAAAAAAAAAAAAAAAAAAAAZAAAAAEBuf///+j///8AAAAACgG4////5////wAAAAAKAAAAAAs=";
        }


    }
}
